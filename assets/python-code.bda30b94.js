import{d as G,c as E,aI as _,D as u,aF as m,b5 as W,aH as i,aJ as b,H as y,aN as h,E as p,aL as X,aK as Y,aM as j,u as A,aG as I,e as d,aT as Z}from"./arco.a18c68e0.js";import{u as M,p as k}from"./query-code.998882bc.js";import{b as ee,_ as te,p as se,y as ae}from"./index.6418be78.js";const oe={class:"code"},ne={class:"width-35"},re={key:2,class:"script"},le={key:0},ce={key:1},ie={class:"start-time"},ue={key:0},fe={key:1,class:"total-time"},he=G({__name:"log",props:{log:{type:Object,default:()=>({})},hasAction:{type:Boolean,default:!0}},setup(r){const n=r,{inputFromNewLineToQueryCode:o,replaceCode:s}=M(),{updateSettings:e}=ee(),t=E(()=>Reflect.has(n.log,"execution_time_ms")),a=()=>{e({queryModalVisible:!0}),n.log.type==="sql"?o(n.log.codeInfo,0):s(n.log.codeInfo)};return(c,f)=>{const v=_("icon-play-arrow"),x=_("a-button"),U=_("a-tooltip"),V=_("a-typography-text"),w=_("a-list-item"),q=_("a-list"),$=_("a-popover"),K=_("icon-check-circle"),R=_("icon-close-circle"),C=_("a-space");return u(),m(w,{class:"smaller-divider"},W({default:i(()=>[b(C,{direction:"vertical",fill:"",size:0},{default:i(()=>[y("div",oe,[r.log.error?(u(),m(U,{key:0,position:"tl",content:r.log.error},{default:i(()=>[y("div",null,h(r.log.error),1)]),_:1},8,["content"])):r.log.type!=="python"?(u(),m($,{key:1,"content-class":"code-popup",position:"tl"},{content:i(()=>[b(q,{size:"small",split:!1,bordered:!1},{default:i(()=>[r.log.type==="promql"?(u(!0),p(X,{key:0},Y(r.log.promInfo,(J,Q)=>(u(),m(w,null,{default:i(()=>[y("span",ne,h(Q),1),b(V,{class:"ml-4",code:""},{default:i(()=>[j(h(J),1)]),_:2},1024)]),_:2},1024))),256)):(u(),m(w,{key:1},{default:i(()=>[b(V,{class:"popup"},{default:i(()=>[j(h(r.log.codeInfo),1)]),_:1})]),_:1}))]),_:1})]),default:i(()=>[y("div",null,h(r.log.codeInfo),1)]),_:1})):(u(),p("div",re,[A(t)?(u(),p("div",le,h(c.$t("dashboard.runScript",{name:r.log.codeInfo})),1)):(u(),p("div",ce,h(c.$t("dashboard.saveName",{name:r.log.codeInfo})),1))]))]),b(C,{class:"info",fill:""},{default:i(()=>[r.log.error?(u(),m(R,{key:1,class:"danger-color"})):(u(),m(K,{key:0,class:"success-color icon-14"})),y("div",ie,h(r.log.startTime),1),r.log.error?I("",!0):(u(),m(C,{key:2,class:"result",fill:"",size:4},{default:i(()=>[A(t)?(u(),p("span",ue,h(r.log.message),1)):I("",!0),A(t)?(u(),p("div",fe,[b($,{"content-class":"total-time-popover"},{content:i(()=>[y("div",null,h(c.$t("dashboard.executeTime",{time:r.log.execution_time_ms})),1),y("div",null,h(c.$t("dashboard.network",{time:r.log.networkTime-r.log.execution_time_ms})),1)]),default:i(()=>[y("div",null,h(`in ${r.log.networkTime} ms`),1)]),_:1})])):I("",!0)]),_:1}))]),_:1})]),_:1})]),_:2},[r.hasAction&&r.log.type!=="python"&&!r.log.error?{name:"actions",fn:i(()=>[b(x,{class:"play",type:"text",size:"small",onClick:a},{icon:i(()=>[b(v,{class:"icon-color"})]),_:1})]),key:"0"}:void 0]),1024)}}});const be=te(he,[["__scopeId","data-v-1aaa167c"]]);class l{constructor(){this._dataLength=0,this._bufferLength=0,this._state=new Int32Array(4),this._buffer=new ArrayBuffer(68),this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()}static hashStr(n,o=!1){return this.onePassHasher.start().appendStr(n).end(o)}static hashAsciiStr(n,o=!1){return this.onePassHasher.start().appendAsciiStr(n).end(o)}static _hex(n){const o=l.hexChars,s=l.hexOut;let e,t,a,c;for(c=0;c<4;c+=1)for(t=c*8,e=n[c],a=0;a<8;a+=2)s[t+1+a]=o.charAt(e&15),e>>>=4,s[t+0+a]=o.charAt(e&15),e>>>=4;return s.join("")}static _md5cycle(n,o){let s=n[0],e=n[1],t=n[2],a=n[3];s+=(e&t|~e&a)+o[0]-680876936|0,s=(s<<7|s>>>25)+e|0,a+=(s&e|~s&t)+o[1]-389564586|0,a=(a<<12|a>>>20)+s|0,t+=(a&s|~a&e)+o[2]+606105819|0,t=(t<<17|t>>>15)+a|0,e+=(t&a|~t&s)+o[3]-1044525330|0,e=(e<<22|e>>>10)+t|0,s+=(e&t|~e&a)+o[4]-176418897|0,s=(s<<7|s>>>25)+e|0,a+=(s&e|~s&t)+o[5]+1200080426|0,a=(a<<12|a>>>20)+s|0,t+=(a&s|~a&e)+o[6]-1473231341|0,t=(t<<17|t>>>15)+a|0,e+=(t&a|~t&s)+o[7]-45705983|0,e=(e<<22|e>>>10)+t|0,s+=(e&t|~e&a)+o[8]+1770035416|0,s=(s<<7|s>>>25)+e|0,a+=(s&e|~s&t)+o[9]-1958414417|0,a=(a<<12|a>>>20)+s|0,t+=(a&s|~a&e)+o[10]-42063|0,t=(t<<17|t>>>15)+a|0,e+=(t&a|~t&s)+o[11]-1990404162|0,e=(e<<22|e>>>10)+t|0,s+=(e&t|~e&a)+o[12]+1804603682|0,s=(s<<7|s>>>25)+e|0,a+=(s&e|~s&t)+o[13]-40341101|0,a=(a<<12|a>>>20)+s|0,t+=(a&s|~a&e)+o[14]-1502002290|0,t=(t<<17|t>>>15)+a|0,e+=(t&a|~t&s)+o[15]+1236535329|0,e=(e<<22|e>>>10)+t|0,s+=(e&a|t&~a)+o[1]-165796510|0,s=(s<<5|s>>>27)+e|0,a+=(s&t|e&~t)+o[6]-1069501632|0,a=(a<<9|a>>>23)+s|0,t+=(a&e|s&~e)+o[11]+643717713|0,t=(t<<14|t>>>18)+a|0,e+=(t&s|a&~s)+o[0]-373897302|0,e=(e<<20|e>>>12)+t|0,s+=(e&a|t&~a)+o[5]-701558691|0,s=(s<<5|s>>>27)+e|0,a+=(s&t|e&~t)+o[10]+38016083|0,a=(a<<9|a>>>23)+s|0,t+=(a&e|s&~e)+o[15]-660478335|0,t=(t<<14|t>>>18)+a|0,e+=(t&s|a&~s)+o[4]-405537848|0,e=(e<<20|e>>>12)+t|0,s+=(e&a|t&~a)+o[9]+568446438|0,s=(s<<5|s>>>27)+e|0,a+=(s&t|e&~t)+o[14]-1019803690|0,a=(a<<9|a>>>23)+s|0,t+=(a&e|s&~e)+o[3]-187363961|0,t=(t<<14|t>>>18)+a|0,e+=(t&s|a&~s)+o[8]+1163531501|0,e=(e<<20|e>>>12)+t|0,s+=(e&a|t&~a)+o[13]-1444681467|0,s=(s<<5|s>>>27)+e|0,a+=(s&t|e&~t)+o[2]-51403784|0,a=(a<<9|a>>>23)+s|0,t+=(a&e|s&~e)+o[7]+1735328473|0,t=(t<<14|t>>>18)+a|0,e+=(t&s|a&~s)+o[12]-1926607734|0,e=(e<<20|e>>>12)+t|0,s+=(e^t^a)+o[5]-378558|0,s=(s<<4|s>>>28)+e|0,a+=(s^e^t)+o[8]-2022574463|0,a=(a<<11|a>>>21)+s|0,t+=(a^s^e)+o[11]+1839030562|0,t=(t<<16|t>>>16)+a|0,e+=(t^a^s)+o[14]-35309556|0,e=(e<<23|e>>>9)+t|0,s+=(e^t^a)+o[1]-1530992060|0,s=(s<<4|s>>>28)+e|0,a+=(s^e^t)+o[4]+1272893353|0,a=(a<<11|a>>>21)+s|0,t+=(a^s^e)+o[7]-155497632|0,t=(t<<16|t>>>16)+a|0,e+=(t^a^s)+o[10]-1094730640|0,e=(e<<23|e>>>9)+t|0,s+=(e^t^a)+o[13]+681279174|0,s=(s<<4|s>>>28)+e|0,a+=(s^e^t)+o[0]-358537222|0,a=(a<<11|a>>>21)+s|0,t+=(a^s^e)+o[3]-722521979|0,t=(t<<16|t>>>16)+a|0,e+=(t^a^s)+o[6]+76029189|0,e=(e<<23|e>>>9)+t|0,s+=(e^t^a)+o[9]-640364487|0,s=(s<<4|s>>>28)+e|0,a+=(s^e^t)+o[12]-421815835|0,a=(a<<11|a>>>21)+s|0,t+=(a^s^e)+o[15]+530742520|0,t=(t<<16|t>>>16)+a|0,e+=(t^a^s)+o[2]-995338651|0,e=(e<<23|e>>>9)+t|0,s+=(t^(e|~a))+o[0]-198630844|0,s=(s<<6|s>>>26)+e|0,a+=(e^(s|~t))+o[7]+1126891415|0,a=(a<<10|a>>>22)+s|0,t+=(s^(a|~e))+o[14]-1416354905|0,t=(t<<15|t>>>17)+a|0,e+=(a^(t|~s))+o[5]-57434055|0,e=(e<<21|e>>>11)+t|0,s+=(t^(e|~a))+o[12]+1700485571|0,s=(s<<6|s>>>26)+e|0,a+=(e^(s|~t))+o[3]-1894986606|0,a=(a<<10|a>>>22)+s|0,t+=(s^(a|~e))+o[10]-1051523|0,t=(t<<15|t>>>17)+a|0,e+=(a^(t|~s))+o[1]-2054922799|0,e=(e<<21|e>>>11)+t|0,s+=(t^(e|~a))+o[8]+1873313359|0,s=(s<<6|s>>>26)+e|0,a+=(e^(s|~t))+o[15]-30611744|0,a=(a<<10|a>>>22)+s|0,t+=(s^(a|~e))+o[6]-1560198380|0,t=(t<<15|t>>>17)+a|0,e+=(a^(t|~s))+o[13]+1309151649|0,e=(e<<21|e>>>11)+t|0,s+=(t^(e|~a))+o[4]-145523070|0,s=(s<<6|s>>>26)+e|0,a+=(e^(s|~t))+o[11]-1120210379|0,a=(a<<10|a>>>22)+s|0,t+=(s^(a|~e))+o[2]+718787259|0,t=(t<<15|t>>>17)+a|0,e+=(a^(t|~s))+o[9]-343485551|0,e=(e<<21|e>>>11)+t|0,n[0]=s+n[0]|0,n[1]=e+n[1]|0,n[2]=t+n[2]|0,n[3]=a+n[3]|0}start(){return this._dataLength=0,this._bufferLength=0,this._state.set(l.stateIdentity),this}appendStr(n){const o=this._buffer8,s=this._buffer32;let e=this._bufferLength,t,a;for(a=0;a<n.length;a+=1){if(t=n.charCodeAt(a),t<128)o[e++]=t;else if(t<2048)o[e++]=(t>>>6)+192,o[e++]=t&63|128;else if(t<55296||t>56319)o[e++]=(t>>>12)+224,o[e++]=t>>>6&63|128,o[e++]=t&63|128;else{if(t=(t-55296)*1024+(n.charCodeAt(++a)-56320)+65536,t>1114111)throw new Error("Unicode standard supports code points up to U+10FFFF");o[e++]=(t>>>18)+240,o[e++]=t>>>12&63|128,o[e++]=t>>>6&63|128,o[e++]=t&63|128}e>=64&&(this._dataLength+=64,l._md5cycle(this._state,s),e-=64,s[0]=s[16])}return this._bufferLength=e,this}appendAsciiStr(n){const o=this._buffer8,s=this._buffer32;let e=this._bufferLength,t,a=0;for(;;){for(t=Math.min(n.length-a,64-e);t--;)o[e++]=n.charCodeAt(a++);if(e<64)break;this._dataLength+=64,l._md5cycle(this._state,s),e=0}return this._bufferLength=e,this}appendByteArray(n){const o=this._buffer8,s=this._buffer32;let e=this._bufferLength,t,a=0;for(;;){for(t=Math.min(n.length-a,64-e);t--;)o[e++]=n[a++];if(e<64)break;this._dataLength+=64,l._md5cycle(this._state,s),e=0}return this._bufferLength=e,this}getState(){const n=this._state;return{buffer:String.fromCharCode.apply(null,Array.from(this._buffer8)),buflen:this._bufferLength,length:this._dataLength,state:[n[0],n[1],n[2],n[3]]}}setState(n){const o=n.buffer,s=n.state,e=this._state;let t;for(this._dataLength=n.length,this._bufferLength=n.buflen,e[0]=s[0],e[1]=s[1],e[2]=s[2],e[3]=s[3],t=0;t<o.length;t+=1)this._buffer8[t]=o.charCodeAt(t)}end(n=!1){const o=this._bufferLength,s=this._buffer8,e=this._buffer32,t=(o>>2)+1;this._dataLength+=o;const a=this._dataLength*8;if(s[o]=128,s[o+1]=s[o+2]=s[o+3]=0,e.set(l.buffer32Identity.subarray(t),t),o>55&&(l._md5cycle(this._state,e),e.set(l.buffer32Identity)),a<=4294967295)e[14]=a;else{const c=a.toString(16).match(/(.*?)(.{0,8})$/);if(c===null)return;const f=parseInt(c[2],16),v=parseInt(c[1],16)||0;e[14]=f,e[15]=v}return l._md5cycle(this._state,e),n?this._state:l._hex(this._state)}}l.stateIdentity=new Int32Array([1732584193,-271733879,-1732584194,271733878]);l.buffer32Identity=new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);l.hexChars="0123456789abcdef";l.hexOut=[];l.onePassHasher=new l;if(l.hashStr("hello")!=="5d41402abc4b2a76b9719d911017c592")throw new Error("Md5 self test failed.");const{saveScript:de}=se(),g=d(""),F=d(""),N=d([]),B=d([]),T=d([]),L=d(""),S=d(!0),H=d(!1),D=d(!1),P=d(!1),z=d(!1),O=E(()=>l.hashStr(g.value)!==l.hashStr(F.value));function ye(){const{pushLog:r}=k(),n=f=>{g.value=g.value.substring(0,T.value[0])+f+g.value.substring(T.value[1])},o=f=>{L.value=f.key,S.value=!1,g.value=f.code,B.value=[f.key],F.value=g.value},s=()=>{L.value="",S.value=!0,g.value="",N.value=[],B.value=[],F.value="",D.value=!1},e=()=>{D.value=!0,O.value?H.value=!0:s()},t=f=>{N.value=[f],S.value=!1,F.value=g.value},a=async(f,v)=>{try{const x=await de(f,v);Z.success({content:ae.global.t("dashboard.saveSuccess"),duration:2*1e3}),r(x,"python")}catch(x){throw r(JSON.parse(x.message),"python")}},c=E(()=>z.value===!0||P.value===!0||L.value.trim().length===0||g.value.trim().length===0);return{insertNameToPyCode:n,overwriteCode:o,createNewScript:e,selectAfterSave:t,resetScript:s,pythonCode:g,lastSavedCode:F,cursorAt:T,scriptName:L,isNewScript:S,scriptSelectedKeys:N,lastSelectedKey:B,isChanged:O,modelVisible:H,creating:D,isButtonDisabled:c,scriptSaving:P,scriptRunning:z,save:a}}export{be as _,ye as u};
