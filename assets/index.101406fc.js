import{u as W,_ as se,a as ne,b as le}from"./list-tabs.9d69dd40.js";import{d as q,e as R,s as ce,c as P,aH as n,C as l,aE as c,aG as s,aI as o,u as t,G as M,aL as j,aM as F,k as ie,b2 as re,aF as ue}from"./arco.3a351844.js";import{o as de,T as pe}from"./index.ecae3f12.js";import{p as me}from"./index.031db1c0.js";import{g as _e,s as G}from"./vue.8d0dec31.js";import{c as H,b as I,g as fe,u as ve,f as ye}from"./index.e4963ae7.js";import"./empty-status.vue_vue_type_script_setup_true_name_EmptyStatus_lang.5b91eb06.js";import"./chart.e63b3ede.js";const be={class:"mr-4"},he={class:"mr-4"},ge={class:"mr-4"},Se=q({__name:"py-editor",props:{spellcheck:{type:Boolean,default:!0},autofocus:{type:Boolean,default:!0},indentWithTab:{type:Boolean,default:!0},tabSize:{default:2}},setup(f){const v=_e(),$=H(),{pythonCode:r,cursorAt:B,lastSavedCode:S,isNewScript:V,scriptName:A,isChanged:d,isButtonDisabled:p,scriptSaving:y,scriptRunning:u,selectAfterSave:z,createNewScript:Q}=W(),{save:k}=W(),{runQuery:w}=I(),{getScriptsTable:C}=$,N="python",b=R(),h=R(),T=R(),m=ce(),i=R({scriptName:A}),J=P(()=>!!(!d.value&&r.value!==""&&i.value.scriptName)),K=e=>{m.value=e.view},O=()=>{if(m.value){const{state:e}=m.value,{ranges:a}=e.selection;if(B.value=[a[0].from,a[0].to],b.value=e.doc.lineAt(a[0].from).number,h.value=e.doc.lineAt(a[0].to).number,e.doc.text)T.value=e.doc.text.slice(b.value-1,h.value).join(" ");else{let g=[];e.doc.children.forEach(x=>{g=g.concat(x.text)}),T.value=g.slice(b.value-1,h.value).join(" ")}}},X={height:"250px"},Y=[me(),de],Z=async()=>{v.name;try{y.value=!0,await k(i.value.scriptName,r.value.trim()),await C(),z(i.value.scriptName)}catch{}y.value=!1},ee=async()=>{v.name;try{u.value=!0,await k(i.value.scriptName,r.value.trim()),S.value=r.value,await w(i.value.scriptName,N),await C(),z(i.value.scriptName)}catch{}u.value=!1},te=async()=>{v.name,u.value=!0,await w(i.value.scriptName,N),u.value=!1};return(e,a)=>{const g=n("a-input"),x=n("a-form-item"),ae=n("a-form"),D=n("icon-loading"),L=n("icon-play-arrow"),U=n("a-button"),E=n("a-space"),oe=n("a-card");return l(),c(oe,{class:"editor-card padding-16",bordered:!1},{default:s(()=>[o(E,{class:"form-space",size:"medium"},{default:s(()=>[o(ae,{layout:"inline",model:t(i)},{default:s(()=>[o(x,{label:e.$t("dashboard.scriptName")},{default:s(()=>[o(g,{"model-value":t(i).scriptName,"onUpdate:modelValue":a[0]||(a[0]=_=>t(i).scriptName=_),disabled:!t(V),placeholder:e.$t("dashboard.input")},null,8,["model-value","disabled","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"]),o(E,null,{default:s(()=>[t(J)?(l(),c(U,{key:0,disabled:t(p),onClick:a[1]||(a[1]=_=>te())},{default:s(()=>[M("div",be,[t(u)?(l(),c(D,{key:0,spin:""})):(l(),c(L,{key:1}))]),j(F(e.$t("dashboard.runScriptAction")),1)]),_:1},8,["disabled"])):(l(),c(E,{key:1},{default:s(()=>[o(U,{disabled:t(p),onClick:a[2]||(a[2]=_=>Z())},{default:s(()=>[M("div",he,[t(y)?(l(),c(D,{key:0,spin:""})):(l(),c(L,{key:1}))]),j(F(e.$t("dashboard.saveScript")),1)]),_:1},8,["disabled"]),o(U,{disabled:t(p),onClick:a[3]||(a[3]=_=>ee())},{default:s(()=>[M("div",ge,[t(u)?(l(),c(D,{key:0,spin:""})):(l(),c(L,{key:1}))]),j(F(e.$t("dashboard.saveAndRun")),1)]),_:1},8,["disabled"])]),_:1}))]),_:1})]),_:1}),o(t(pe),{modelValue:t(r),"onUpdate:modelValue":a[4]||(a[4]=_=>ie(r)?r.value=_:null),style:X,spellcheck:f.spellcheck,autofocus:f.autofocus,"indent-with-tab":f.indentWithTab,tabSize:f.tabSize,extensions:Y,onReady:K,onUpdate:O},null,8,["modelValue","spellcheck","autofocus","indent-with-tab","tabSize"])]),_:1})}}}),Ve=q({__name:"index",setup(f){const{getResultsByType:v}=I(),{logs:$}=G(fe()),{codeType:r,guideModalVisible:B}=G(ve()),{dataStatusMap:S}=G(ye()),{getTables:V,getScriptsTable:A}=H(),d=["python"],p=P(()=>v(d)),y=P(()=>$.value.filter(u=>d.includes(u.type)));return re(()=>{r.value="python",B.value||(S.value.scripts||A(),S.value.tables||V())}),(u,z)=>{const Q=se,k=n("a-layout-sider"),w=Se,C=ne,N=le,b=n("a-space"),h=n("a-layout-content"),T=n("a-layout");return l(),c(T,{class:"layout"},{default:s(()=>[o(k,{"resize-directions":["right"],width:321},{default:s(()=>[o(Q,{has:["Tables","Scripts"]})]),_:1}),o(h,null,{default:s(()=>[o(b,{class:"content-space",direction:"vertical",fill:"",size:"large"},{default:s(()=>{var m;return[o(w),(m=t(p))!=null&&m.length?(l(),c(C,{key:0,results:t(p),types:d},null,8,["results"])):ue("",!0),o(N,{logs:t(y),types:d},null,8,["logs"])]}),_:1})]),_:1})]),_:1})}}});export{Ve as default};
