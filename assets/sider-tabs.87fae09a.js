import{d as O,c as g,aH as w,C as N,aE as B,aG as L,aI as M,E as H,u as p,b5 as V,aL as U,aM as j,G as I,e as h,aS as K}from"./arco.f573c5ac.js";import{u as G,c as q,i as Q,N as W,V as Y,a as z}from"./index.b09ea387.js";import{s as J}from"./vue.67fd90f7.js";const X=I("svg",{class:"icon-18"},[I("use",{href:"#query"})],-1),re=O({__name:"index",props:{label:null,type:null,node:null,parent:null},setup(d){const n=d,{inputFromNewLineToQueryCode:a}=G(),{updateSettings:s}=q(),e=(u,l)=>{a(u,l),s({queryModalVisible:!0})},t=u=>u,r=(u,l,c)=>{const b=c.timeIndexName!=="%TIMESTAMP%"?` ORDER BY ${c.timeIndexName} `:" ";switch(u){case"select*100":return{code:t(`SELECT * FROM "${c.title}"${b}LIMIT 100;`),cursorPosition:0};case"count":return{code:t(`SELECT count(*) FROM "${c.title}" GROUP BY ${l.title};`),cursorPosition:0};case"where=":return{code:t(`SELECT * FROM "${c.title}" WHERE ${l.title} = ${b}DESC;`),cursorPosition:`${b}DESC;`.length};case"select100":return{code:t(`SELECT ${l.title} FROM "${c.title}"${b}DESC LIMIT 100;`),cursorPosition:0};case"max":return{code:t(`SELECT max(${l.title}) FROM "${c.title}";`),cursorPosition:0};case"min":return{code:t(`SELECT min(${l.title}) FROM "${c.title}";`),cursorPosition:0};case"where<":return{code:t(`SELECT * FROM "${c.title}" WHERE ${c.timeIndexName} < ${b}DESC LIMIT 100;`),cursorPosition:`${b}DESC LIMIT 100;`.length};default:return{code:"",cursorPosition:0}}},i=g(()=>r(n.type,n.node,n.parent));return(u,l)=>{const c=w("a-button"),b=w("a-tooltip");return N(),B(b,{content:p(i).code},{default:L(()=>[M(c,{type:"text",class:H({"arco-btn-only-icon":d.label===""}),onClick:l[0]||(l[0]=k=>e(p(i).code,p(i).cursorPosition))},V({default:L(()=>[U(j(d.label),1)]),_:2},[d.label===""?{name:"icon",fn:L(()=>[X]),key:"0"}:void 0]),1032,["class"])]),_:1},8,["content"])}}});class o{constructor(){this._dataLength=0,this._bufferLength=0,this._state=new Int32Array(4),this._buffer=new ArrayBuffer(68),this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()}static hashStr(n,a=!1){return this.onePassHasher.start().appendStr(n).end(a)}static hashAsciiStr(n,a=!1){return this.onePassHasher.start().appendAsciiStr(n).end(a)}static _hex(n){const a=o.hexChars,s=o.hexOut;let e,t,r,i;for(i=0;i<4;i+=1)for(t=i*8,e=n[i],r=0;r<8;r+=2)s[t+1+r]=a.charAt(e&15),e>>>=4,s[t+0+r]=a.charAt(e&15),e>>>=4;return s.join("")}static _md5cycle(n,a){let s=n[0],e=n[1],t=n[2],r=n[3];s+=(e&t|~e&r)+a[0]-680876936|0,s=(s<<7|s>>>25)+e|0,r+=(s&e|~s&t)+a[1]-389564586|0,r=(r<<12|r>>>20)+s|0,t+=(r&s|~r&e)+a[2]+606105819|0,t=(t<<17|t>>>15)+r|0,e+=(t&r|~t&s)+a[3]-1044525330|0,e=(e<<22|e>>>10)+t|0,s+=(e&t|~e&r)+a[4]-176418897|0,s=(s<<7|s>>>25)+e|0,r+=(s&e|~s&t)+a[5]+1200080426|0,r=(r<<12|r>>>20)+s|0,t+=(r&s|~r&e)+a[6]-1473231341|0,t=(t<<17|t>>>15)+r|0,e+=(t&r|~t&s)+a[7]-45705983|0,e=(e<<22|e>>>10)+t|0,s+=(e&t|~e&r)+a[8]+1770035416|0,s=(s<<7|s>>>25)+e|0,r+=(s&e|~s&t)+a[9]-1958414417|0,r=(r<<12|r>>>20)+s|0,t+=(r&s|~r&e)+a[10]-42063|0,t=(t<<17|t>>>15)+r|0,e+=(t&r|~t&s)+a[11]-1990404162|0,e=(e<<22|e>>>10)+t|0,s+=(e&t|~e&r)+a[12]+1804603682|0,s=(s<<7|s>>>25)+e|0,r+=(s&e|~s&t)+a[13]-40341101|0,r=(r<<12|r>>>20)+s|0,t+=(r&s|~r&e)+a[14]-1502002290|0,t=(t<<17|t>>>15)+r|0,e+=(t&r|~t&s)+a[15]+1236535329|0,e=(e<<22|e>>>10)+t|0,s+=(e&r|t&~r)+a[1]-165796510|0,s=(s<<5|s>>>27)+e|0,r+=(s&t|e&~t)+a[6]-1069501632|0,r=(r<<9|r>>>23)+s|0,t+=(r&e|s&~e)+a[11]+643717713|0,t=(t<<14|t>>>18)+r|0,e+=(t&s|r&~s)+a[0]-373897302|0,e=(e<<20|e>>>12)+t|0,s+=(e&r|t&~r)+a[5]-701558691|0,s=(s<<5|s>>>27)+e|0,r+=(s&t|e&~t)+a[10]+38016083|0,r=(r<<9|r>>>23)+s|0,t+=(r&e|s&~e)+a[15]-660478335|0,t=(t<<14|t>>>18)+r|0,e+=(t&s|r&~s)+a[4]-405537848|0,e=(e<<20|e>>>12)+t|0,s+=(e&r|t&~r)+a[9]+568446438|0,s=(s<<5|s>>>27)+e|0,r+=(s&t|e&~t)+a[14]-1019803690|0,r=(r<<9|r>>>23)+s|0,t+=(r&e|s&~e)+a[3]-187363961|0,t=(t<<14|t>>>18)+r|0,e+=(t&s|r&~s)+a[8]+1163531501|0,e=(e<<20|e>>>12)+t|0,s+=(e&r|t&~r)+a[13]-1444681467|0,s=(s<<5|s>>>27)+e|0,r+=(s&t|e&~t)+a[2]-51403784|0,r=(r<<9|r>>>23)+s|0,t+=(r&e|s&~e)+a[7]+1735328473|0,t=(t<<14|t>>>18)+r|0,e+=(t&s|r&~s)+a[12]-1926607734|0,e=(e<<20|e>>>12)+t|0,s+=(e^t^r)+a[5]-378558|0,s=(s<<4|s>>>28)+e|0,r+=(s^e^t)+a[8]-2022574463|0,r=(r<<11|r>>>21)+s|0,t+=(r^s^e)+a[11]+1839030562|0,t=(t<<16|t>>>16)+r|0,e+=(t^r^s)+a[14]-35309556|0,e=(e<<23|e>>>9)+t|0,s+=(e^t^r)+a[1]-1530992060|0,s=(s<<4|s>>>28)+e|0,r+=(s^e^t)+a[4]+1272893353|0,r=(r<<11|r>>>21)+s|0,t+=(r^s^e)+a[7]-155497632|0,t=(t<<16|t>>>16)+r|0,e+=(t^r^s)+a[10]-1094730640|0,e=(e<<23|e>>>9)+t|0,s+=(e^t^r)+a[13]+681279174|0,s=(s<<4|s>>>28)+e|0,r+=(s^e^t)+a[0]-358537222|0,r=(r<<11|r>>>21)+s|0,t+=(r^s^e)+a[3]-722521979|0,t=(t<<16|t>>>16)+r|0,e+=(t^r^s)+a[6]+76029189|0,e=(e<<23|e>>>9)+t|0,s+=(e^t^r)+a[9]-640364487|0,s=(s<<4|s>>>28)+e|0,r+=(s^e^t)+a[12]-421815835|0,r=(r<<11|r>>>21)+s|0,t+=(r^s^e)+a[15]+530742520|0,t=(t<<16|t>>>16)+r|0,e+=(t^r^s)+a[2]-995338651|0,e=(e<<23|e>>>9)+t|0,s+=(t^(e|~r))+a[0]-198630844|0,s=(s<<6|s>>>26)+e|0,r+=(e^(s|~t))+a[7]+1126891415|0,r=(r<<10|r>>>22)+s|0,t+=(s^(r|~e))+a[14]-1416354905|0,t=(t<<15|t>>>17)+r|0,e+=(r^(t|~s))+a[5]-57434055|0,e=(e<<21|e>>>11)+t|0,s+=(t^(e|~r))+a[12]+1700485571|0,s=(s<<6|s>>>26)+e|0,r+=(e^(s|~t))+a[3]-1894986606|0,r=(r<<10|r>>>22)+s|0,t+=(s^(r|~e))+a[10]-1051523|0,t=(t<<15|t>>>17)+r|0,e+=(r^(t|~s))+a[1]-2054922799|0,e=(e<<21|e>>>11)+t|0,s+=(t^(e|~r))+a[8]+1873313359|0,s=(s<<6|s>>>26)+e|0,r+=(e^(s|~t))+a[15]-30611744|0,r=(r<<10|r>>>22)+s|0,t+=(s^(r|~e))+a[6]-1560198380|0,t=(t<<15|t>>>17)+r|0,e+=(r^(t|~s))+a[13]+1309151649|0,e=(e<<21|e>>>11)+t|0,s+=(t^(e|~r))+a[4]-145523070|0,s=(s<<6|s>>>26)+e|0,r+=(e^(s|~t))+a[11]-1120210379|0,r=(r<<10|r>>>22)+s|0,t+=(s^(r|~e))+a[2]+718787259|0,t=(t<<15|t>>>17)+r|0,e+=(r^(t|~s))+a[9]-343485551|0,e=(e<<21|e>>>11)+t|0,n[0]=s+n[0]|0,n[1]=e+n[1]|0,n[2]=t+n[2]|0,n[3]=r+n[3]|0}start(){return this._dataLength=0,this._bufferLength=0,this._state.set(o.stateIdentity),this}appendStr(n){const a=this._buffer8,s=this._buffer32;let e=this._bufferLength,t,r;for(r=0;r<n.length;r+=1){if(t=n.charCodeAt(r),t<128)a[e++]=t;else if(t<2048)a[e++]=(t>>>6)+192,a[e++]=t&63|128;else if(t<55296||t>56319)a[e++]=(t>>>12)+224,a[e++]=t>>>6&63|128,a[e++]=t&63|128;else{if(t=(t-55296)*1024+(n.charCodeAt(++r)-56320)+65536,t>1114111)throw new Error("Unicode standard supports code points up to U+10FFFF");a[e++]=(t>>>18)+240,a[e++]=t>>>12&63|128,a[e++]=t>>>6&63|128,a[e++]=t&63|128}e>=64&&(this._dataLength+=64,o._md5cycle(this._state,s),e-=64,s[0]=s[16])}return this._bufferLength=e,this}appendAsciiStr(n){const a=this._buffer8,s=this._buffer32;let e=this._bufferLength,t,r=0;for(;;){for(t=Math.min(n.length-r,64-e);t--;)a[e++]=n.charCodeAt(r++);if(e<64)break;this._dataLength+=64,o._md5cycle(this._state,s),e=0}return this._bufferLength=e,this}appendByteArray(n){const a=this._buffer8,s=this._buffer32;let e=this._bufferLength,t,r=0;for(;;){for(t=Math.min(n.length-r,64-e);t--;)a[e++]=n[r++];if(e<64)break;this._dataLength+=64,o._md5cycle(this._state,s),e=0}return this._bufferLength=e,this}getState(){const n=this._state;return{buffer:String.fromCharCode.apply(null,Array.from(this._buffer8)),buflen:this._bufferLength,length:this._dataLength,state:[n[0],n[1],n[2],n[3]]}}setState(n){const a=n.buffer,s=n.state,e=this._state;let t;for(this._dataLength=n.length,this._bufferLength=n.buflen,e[0]=s[0],e[1]=s[1],e[2]=s[2],e[3]=s[3],t=0;t<a.length;t+=1)this._buffer8[t]=a.charCodeAt(t)}end(n=!1){const a=this._bufferLength,s=this._buffer8,e=this._buffer32,t=(a>>2)+1;this._dataLength+=a;const r=this._dataLength*8;if(s[a]=128,s[a+1]=s[a+2]=s[a+3]=0,e.set(o.buffer32Identity.subarray(t),t),a>55&&(o._md5cycle(this._state,e),e.set(o.buffer32Identity)),r<=4294967295)e[14]=r;else{const i=r.toString(16).match(/(.*?)(.{0,8})$/);if(i===null)return;const u=parseInt(i[2],16),l=parseInt(i[1],16)||0;e[14]=u,e[15]=l}return o._md5cycle(this._state,e),n?this._state:o._hex(this._state)}}o.stateIdentity=new Int32Array([1732584193,-271733879,-1732584194,271733878]);o.buffer32Identity=new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);o.hexChars="0123456789abcdef";o.hexOut=[];o.onePassHasher=new o;if(o.hashStr("hello")!=="5d41402abc4b2a76b9719d911017c592")throw new Error("Md5 self test failed.");const{saveScript:Z}=Q(),f=h(""),_=h(""),y=h([]),m=h([]),C=h([]),v=h(""),S=h(!0),A=h(!1),x=h(!1),$=h(!1),T=h(!1),P=g(()=>o.hashStr(f.value)!==o.hashStr(_.value));function ae(){const{pushLog:d}=W(),n=u=>{f.value=f.value.substring(0,C.value[0])+u+f.value.substring(C.value[1])},a=u=>{v.value=u.key,S.value=!1,f.value=u.code,m.value=[u.key],_.value=f.value},s=()=>{v.value="",S.value=!0,f.value="",y.value=[],m.value=[],_.value="",x.value=!1},e=()=>{x.value=!0,P.value?A.value=!0:s()},t=u=>{y.value=[u],S.value=!1,_.value=f.value},r=async(u,l)=>{try{const c=await Z(u,l);K.success({content:Y.global.t("dashboard.saveSuccess"),duration:2*1e3}),d(c,"python")}catch(c){throw d(JSON.parse(c.message),"python")}},i=g(()=>T.value===!0||$.value===!0||v.value.trim().length===0||f.value.trim().length===0);return{insertNameToPyCode:n,overwriteCode:a,createNewScript:e,selectAfterSave:t,resetScript:s,pythonCode:f,lastSavedCode:_,cursorAt:C,scriptName:v,isNewScript:S,scriptSelectedKeys:y,lastSelectedKey:m,isChanged:P,modelVisible:A,creating:x,isButtonDisabled:i,scriptSaving:$,scriptRunning:T,save:r}}const F=h(""),E=h(""),{originTablesTree:D,originScriptsList:R}=J(z());function ne(){const d=s=>(t=>{const r=[];return t.forEach(i=>{i.title.toLowerCase().indexOf(s.toLowerCase())>-1&&r.push({...i})}),r})(R.value),n=g(()=>F.value?D.value.filter(s=>s.title.toLowerCase().indexOf(F.value.toLowerCase())>-1):D.value),a=g(()=>E.value?d(E.value):R.value);return{tablesSearchKey:F,scriptsSearchKey:E,tablesTreeData:n,scriptsListData:a}}export{re as _,ne as a,ae as u};
